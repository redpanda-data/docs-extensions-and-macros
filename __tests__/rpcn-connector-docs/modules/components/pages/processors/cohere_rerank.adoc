= cohere_rerank
// tag::single-source[]
:type: processor
:status: experimental
:categories: [AI]
:description: Generates vector embeddings to represent input text, using the Cohere API.

component_type_dropdown::[]

// This content is autogenerated. Do not edit manually. To override descriptions or summaries, use the doc-tools CLI with the --overrides option.

Generates vector embeddings to represent input text, using the Cohere API.

ifndef::env-cloud[]
Introduced in version 4.37.0.
endif::[]

[tabs]
======
Common::
+
--
```yaml
processor:
  label: ""
  cohere_rerank:
    base_url: "https://api.cohere.com"
    api_key: "" # No default (required)
    model: "" # No default (required)
    query: "" # No default (required)
    documents: "" # No default (required)
    top_n: 0
    max_tokens_per_doc: 4096
```
--
Advanced::
+
--
```yaml
processor:
  label: ""
  cohere_rerank:
    base_url: "https://api.cohere.com"
    api_key: "" # No default (required)
    model: "" # No default (required)
    query: "" # No default (required)
    documents: "" # No default (required)
    top_n: 0
    max_tokens_per_doc: 4096
```
--
======


This processor sends document strings to the Cohere API, which reranks them based on the relevance to the query.

To learn more about reranking, see the https://docs.cohere.com/docs/rerank-2[Cohere API documentation^].

The output of this processor is an array of strings that are ordered by their relevance.

== Metadata

relevance_scores: an array of scores for each document, indicating how relevant it is to the query. The scores are in the same order as the documents in the input. The higher the score, the more relevant the document is to the query.

		

// This content is autogenerated. Do not edit manually. To override descriptions, use the doc-tools CLI with the --overrides option.

== Fields

=== `api_key`

The API key for the Cohere API.

include::redpanda-connect:components:partial$secret_warning.adoc[]

*Type*: `string`

=== `base_url`

The base URL to use for API requests.

*Type*: `string`

*Default*: `https://api.cohere.com`

=== `documents`

A list of texts that will be compared to the query. For optimal performance Cohere recommends against sending more than 1000 documents in a single request. NOTE: structured data should be formatted as YAML for best performance.

*Type*: `string`

=== `max_tokens_per_doc`

Long documents will be automatically truncated to the specified number of tokens.

*Type*: `int`

*Default*: `4096`

=== `model`

The name of the Cohere model to use.

*Type*: `string`

[source,yaml]
----
# Examples:
model: rerank-v3.5

----

=== `query`

The search query

*Type*: `string`

=== `top_n`

The number of documents to return, if 0 all documents are returned.

*Type*: `int`

*Default*: `0`



// This content is autogenerated. Do not edit manually.

== Examples

=== Rerank some documents based on a query

Rerank some documents based on a query

[source,yaml]
----
input:
  generate:
    interval: 1s
    mapping: |
      root = {
        "query": fake("sentence"),
        "docs": [fake("paragraph"), fake("paragraph"), fake("paragraph")],
      }
pipeline:
  processors:
  - cohere_rerank:
      model: rerank-v3.5
      api_key: "${COHERE_API_KEY}"
      query: "${!this.query}"
      documents: "root = this.docs"
output:
  stdout: {}
----


