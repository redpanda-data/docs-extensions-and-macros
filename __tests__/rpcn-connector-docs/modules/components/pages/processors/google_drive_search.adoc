= google_drive_search
// tag::single-source[]
:type: processor
:status: experimental
:categories: [Unstructured]
:description: Searches Google Drive for files matching the provided query.

component_type_dropdown::[]

// This content is autogenerated. Do not edit manually. To override descriptions or summaries, use the doc-tools CLI with the --overrides option.

Searches Google Drive for files matching the provided query.


[tabs]
======
Common::
+
--
```yaml
processor:
  label: ""
  google_drive_search:
    credentials_json: "" # No default (optional)
    query: "" # No default (required)
    projection:
      - id
      - name
      - mimeType
      - size
      - labelInfo
    include_label_ids: ""
    max_results: 64
```
--
Advanced::
+
--
```yaml
processor:
  label: ""
  google_drive_search:
    credentials_json: "" # No default (optional)
    query: "" # No default (required)
    projection:
      - id
      - name
      - mimeType
      - size
      - labelInfo
    include_label_ids: ""
    max_results: 64
```
--
======


This processor searches for files in Google Drive using the provided query.

Search results are emitted as message batch, where each message is a https://developers.google.com/workspace/drive/api/reference/rest/v3/files#File[^Google Drive File]

== Authentication
By default, this connector will use Google Application Default Credentials (ADC) to authenticate with Google APIs.

To use this mechanism locally, the following gcloud commands can be used:

	# Login for the application default credentials and add scopes for readonly drive access
	gcloud auth application-default login --scopes='openid,https://www.googleapis.com/auth/userinfo.email,https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/drive.readonly'
	# When logging in with a user account, you may need to set the quota project for the application default credentials
	gcloud auth application-default set-quota-project <project-id>

Otherwise if using a service account, you can create a JSON key for the service account and set it in the `credentials_json` field.
In order for a service account to access files in Google Drive either files need to be explicitly shared with the service account email, otherwise https://support.google.com/a/answer/162106[^domain wide delegation] can be used to share all files within a Google Workspace.


// This content is autogenerated. Do not edit manually. To override descriptions, use the doc-tools CLI with the --overrides option.

== Fields

=== `credentials_json`

A service account credentials JSON file. If left unset then the application default credentials are used.

include::redpanda-connect:components:partial$secret_warning.adoc[]

*Type*: `string`

=== `include_label_ids`

A comma delimited list of label IDs to include in the result

*Type*: `string`

*Default*: `""`

=== `max_results`

The maximum number of results to return.

*Type*: `int`

*Default*: `64`

=== `projection[]`

The partial fields to include in the result.

*Type*: `string`

*Default*:
[source,yaml]
----
- id
- name
- mimeType
- size
- labelInfo
----

=== `query`

The search query to use for finding files in Google Drive. Supports the same query format as the Google Drive UI.

*Type*: `string`



// This content is autogenerated. Do not edit manually.

== Examples

=== Search & download files from Google Drive

This examples downloads all the files from Google Drive that are returned in the query

[source,yaml]
----
input:
  stdin: {}
pipeline:
  processors:
    - google_drive_search:
        query: "${!content().string()}"
    - mutation: 'meta path = this.name'
    - google_drive_download:
        file_id: "${!this.id}"
        mime_type: "${!this.mimeType}"
output:
  file:
    path: "${!@path}"
    codec: all-bytes
----


