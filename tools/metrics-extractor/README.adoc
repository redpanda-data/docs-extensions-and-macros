= Redpanda Metrics Extractor
:description: Automated extraction of metrics from Redpanda source code
:page-categories: Development, Documentation, Automation

This tool extracts Redpanda metrics from C++ source code and generates documentation in AsciiDoc format.

== Usage for Writers

=== Quick Start

Generate metrics documentation from a GitHub tag or branch:

[source,bash]
----
# Extract from specific tag (recommended)
npx doc-tools generate source-metrics-docs --tag v25.2.1-rc4

# Extract from development branch
npx doc-tools generate source-metrics-docs --tag dev
----

=== Local Development

If you have a local Redpanda repository:

[source,bash]
----
npx doc-tools generate metrics-docs --redpanda-repo /path/to/redpanda
----

=== Output Files

All commands generate three files in the `autogenerated/` directory:

* `internal_metrics_reference.adoc` - Internal metrics for engineering documentation
* `public_metrics_reference.adoc` - Public metrics for user-facing documentation  
* `metrics.json` - Machine-readable metrics data

== Technical Details

The tool automatically extracts metrics created with these constructors:

* `sm::make_gauge`, `sm::make_counter`, `sm::make_histogram`
* `sm::make_total_bytes`, `sm::make_derive`
* `ss::metrics::make_total_operations`, `ss::metrics::make_current_bytes`

For each metric, it extracts:
* Name and type (gauge, counter, histogram)
* Description and labels
* Classification (internal vs external)
* Source location
== Prerequisites

* Python 3.8+ and build tools (for tree-sitter compilation)
* Git

== Development Commands

For developers working on the tool itself:

[source,bash]
----
# Set up development environment
make setup-venv
make install-deps

# Run tests
make test

# Manual extraction (development)
python metrics_extractor.py --redpanda-repo /path/to/redpanda/src --verbose
----
